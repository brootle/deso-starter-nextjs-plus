(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{4408:e=>{e.exports={notificationsContainer:"page_notificationsContainer__ySYM7"}},5663:(e,i,n)=>{"use strict";n.d(i,{NotificationsPageClient:()=>H});var o=n(5155),s=n(9644),t=n(7183),a=n(5838),l=n(8822),r=n(2115),c=n(6189),d=n.n(c);let u=e=>{var i;let{notification:n}=e;return(0,o.jsxs)("div",{className:d().notification,children:[(null==n?void 0:n.Index)&&(0,o.jsx)("span",{children:n.Index})," |"," ",(null==n?void 0:null===(i=n.Metadata)||void 0===i?void 0:i.TxnType)&&(0,o.jsx)("span",{children:n.Metadata.TxnType})]})};var f=n(6874),_=n.n(f),h=n(9987);let v=e=>{let{profile:i,publicKey:n,isUnfollow:s}=e,a=(null==i?void 0:i.Username)||n,l=(0,t.b)(a)?a:"@".concat(a);return(0,o.jsxs)("div",{className:d().notification,children:[(0,o.jsxs)("div",{role:"img","aria-label":"follow",className:d().followIcon,children:[(0,o.jsx)("div",{children:"\uD83E\uDD35"}),(0,o.jsx)("div",{className:d().plusIcon,children:"➕"})]}),(0,o.jsx)("div",{className:d().notificationContent,children:(0,o.jsxs)("div",{className:d().notificationHeader,children:[(0,o.jsxs)(_(),{href:"/".concat(a),children:[(0,o.jsx)(h.e,{profile:i,size:48,className:d().avatar}),(0,o.jsx)(h.e,{profile:i,size:45,className:d().avatarMobile})]}),(0,o.jsx)("div",{className:d().notificationSummary,children:(0,o.jsxs)("div",{children:[(0,o.jsx)(_(),{href:"/".concat(a),children:l})," ",s?" unfollowed you":" started following you"]})})]})})]})};var p=n(9300),m=n.n(p),x=n(6715),N=n(7257),j=n(3721);let b=e=>{let{profile:i,publicKey:n,submittedPost:s,submittedPostHex:t,parentPost:a}=e,l=(0,x.useQueryClient)(),c=null==s?void 0:s.PostHashHex,[u,f]=(0,r.useState)(()=>{var e;return null!==(e=l.getQueryData(N.lT.parentPostVisible(c)))&&void 0!==e&&e}),h=m()(d().notificationWithThread,{[d().open]:u});return s?(0,o.jsxs)("div",{className:h,children:[a&&(0,o.jsx)("button",{className:d().toggleButton,onClick:()=>{let e=!u;l.setQueryData(N.lT.parentPostVisible(c),e),f(e)},children:u?"Hide":"Replied to..."}),a&&u&&(0,o.jsx)("div",{className:d().parentPostContainer,children:(0,o.jsx)(j.L,{post:a})}),(0,o.jsx)("div",{className:d().submittedPostContainer,children:(0,o.jsx)(j.L,{post:s})})]}):(0,o.jsx)("div",{className:d().notification,children:(0,o.jsx)("div",{className:d().notificationContent,children:(0,o.jsx)("div",{className:d().notificationHeader,children:(0,o.jsxs)("span",{className:d().error,children:["Post by"," ",(0,o.jsx)(_(),{href:"/".concat(n),prefetch:!1,children:n})," ","not found. Check it at"," ",(0,o.jsx)(_(),{href:"/".concat(n,"/posts/").concat(t),className:d().postLink,prefetch:!1,children:t})]})})})})},P=e=>{var i;let{profile:n,publicKey:s,post:a,diamondLevel:l}=e,r=(null==n?void 0:n.Username)||s,c=(0,t.b)(r)?r:"@".concat(r),u=null==a?void 0:null===(i=a.ProfileEntryResponse)||void 0===i?void 0:i.Username,f=null==a?void 0:a.PosterPublicKeyBase58Check,v=null==a?void 0:a.PostHashHex,p=v&&(u||f);return(0,o.jsxs)("div",{className:d().notification,children:[(0,o.jsx)("div",{role:"img","aria-label":"diamond",className:d().diamondsIcon,children:Array.from({length:l},(e,i)=>(0,o.jsx)("div",{children:"\uD83D\uDC8E"},i))}),(0,o.jsxs)("div",{className:d().notificationContent,children:[(0,o.jsxs)("div",{className:d().notificationHeader,children:[(0,o.jsxs)(_(),{href:"/".concat(r),children:[(0,o.jsx)(h.e,{profile:n,size:48,className:d().avatar}),(0,o.jsx)(h.e,{profile:n,size:45,className:d().avatarMobile})]}),(0,o.jsxs)("div",{className:d().notificationSummary,children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(_(),{href:"/".concat(r),children:c})," diamonded your post"]}),p&&(0,o.jsx)("div",{className:d().postLinkWrapper,children:(0,o.jsx)(_(),{href:"/".concat(u||f,"/posts/").concat(v),className:d().postLink,prefetch:!1,children:v})})]})]}),(null==a?void 0:a.Body)&&(0,o.jsx)("div",{className:d().postSnippet,children:a.Body})]})]})},y={LIKE:"\uD83D\uDC4D",LOVE:"❤️",LAUGH:"\uD83D\uDE02",ASTONISHED:"\uD83D\uDE32",SAD:"\uD83D\uDE22",ANGRY:"\uD83D\uDE20",DISLIKE:"\uD83D\uDC4E"},k=e=>{var i;let{profile:n,publicKey:s,post:a,reaction:l}=e,r=(null==n?void 0:n.Username)||s,c=(0,t.b)(r)?r:"@".concat(r),u=d()[null==l?void 0:l.toLowerCase()]||"",f=null==a?void 0:null===(i=a.ProfileEntryResponse)||void 0===i?void 0:i.Username,v=null==a?void 0:a.PosterPublicKeyBase58Check,p=null==a?void 0:a.PostHashHex,x=p&&(f||v);return(0,o.jsxs)("div",{className:d().notification,children:[(0,o.jsx)("div",{role:"img","aria-label":"reaction",className:d().reactionIcon,children:(0,o.jsx)("div",{children:"✨"})}),(0,o.jsxs)("div",{className:d().notificationContent,children:[(0,o.jsxs)("div",{className:d().notificationHeader,children:[(0,o.jsxs)(_(),{href:"/".concat(r),children:[(0,o.jsx)(h.e,{profile:n,size:48,className:d().avatar}),(0,o.jsx)(h.e,{profile:n,size:45,className:d().avatarMobile})]}),(0,o.jsxs)("div",{className:d().notificationSummary,children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(_(),{href:"/".concat(r),children:c})," reacted"," ",(0,o.jsx)("span",{className:m()(d().reactionEmoji,u),children:y[l]||"❓"})," ","at your post"]}),x&&(0,o.jsx)("div",{className:d().postLinkWrapper,children:(0,o.jsx)(_(),{href:"/".concat(f||v,"/posts/").concat(p),className:d().postLink,prefetch:!1,children:p})})]})]}),(null==a?void 0:a.Body)&&(0,o.jsx)("div",{className:d().postSnippet,children:a.Body})]})]})},g=e=>{let{profile:i,publicKey:n,nanosAmount:s}=e,a=(null==i?void 0:i.Username)||n,l=(0,t.b)(a)?a:"@".concat(a),r=(s/1e9).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:8});return(0,o.jsxs)("div",{className:d().notification,children:[(0,o.jsx)("div",{role:"img","aria-label":"deso transfer",className:d().transferIcon,children:"\uD83D\uDCB8"}),(0,o.jsx)("div",{className:d().notificationContent,children:(0,o.jsxs)("div",{className:d().notificationHeader,children:[(0,o.jsxs)(_(),{href:"/".concat(a),children:[(0,o.jsx)(h.e,{profile:i,size:48,className:d().avatar}),(0,o.jsx)(h.e,{profile:i,size:45,className:d().avatarMobile})]}),(0,o.jsx)("div",{className:d().notificationSummary,children:(0,o.jsxs)("div",{children:[(0,o.jsx)(_(),{href:"/".concat(a),children:l})," sent you ",r," ",(0,o.jsx)(_(),{href:"/deso",children:"$DESO"}),"!"]})})]})})]})},C=e=>{var i,n,s,t;let{notification:a,postsByHash:l,profilesByPublicKey:r}=e,{Metadata:c}=a,d=null==c?void 0:c.TxnType,f=null==c?void 0:c.TransactorPublicKeyBase58Check,_=null==r?void 0:r[f],h=null==c?void 0:c.BasicTransferTxindexMetadata,{SubmitPostTxindexMetadata:p}=c||{},m=null==l?void 0:l[null==p?void 0:p.PostHashBeingModifiedHex],x=null==p?void 0:p.PostHashBeingModifiedHex,N=null==l?void 0:l[null==p?void 0:p.ParentPostHashHex],j=(null==h?void 0:h.DiamondLevel)>0&&(null==h?void 0:h.PostHashHex)&&h.PostHashHex.length>0,y=(null==c?void 0:null===(i=c.CreatePostAssociationTxindexMetadata)||void 0===i?void 0:i.AssociationType)==="REACTION";switch(d){case"FOLLOW":return(0,o.jsx)(v,{profile:_,publicKey:f,isUnfollow:null==c?void 0:null===(n=c.FollowTxindexMetadata)||void 0===n?void 0:n.IsUnfollow});case"SUBMIT_POST":return(0,o.jsx)(b,{profile:_,publicKey:f,submittedPost:m,submittedPostHex:x,parentPost:N});case"SUBMIT_POST":return(0,o.jsx)(b,{profile:_,publicKey:f,submittedPost:m,parentPost:N});case"BASIC_TRANSFER":if(j){let e=null==l?void 0:l[h.PostHashHex];return(0,o.jsx)(P,{profile:_,publicKey:f,post:e,diamondLevel:h.DiamondLevel})}return(0,o.jsx)(g,{profile:_,publicKey:f,nanosAmount:null==h?void 0:h.TotalOutputNanos});case"CREATE_POST_ASSOCIATION":if(y){let e=null==l?void 0:l[null==c?void 0:null===(s=c.CreatePostAssociationTxindexMetadata)||void 0===s?void 0:s.PostHashHex],i=null==c?void 0:null===(t=c.CreatePostAssociationTxindexMetadata)||void 0===t?void 0:t.AssociationValue;return(0,o.jsx)(k,{profile:_,publicKey:f,post:e,reaction:i})}return(0,o.jsx)(u,{notification:a});default:return(0,o.jsx)(u,{notification:a})}};var I=n(8725),L=n(4408),w=n.n(L);let H=e=>{let{rawParam:i}=e,n=(0,t.b)(i),c=n?i:i.startsWith("@")?i.slice(1):i,{getSingleProfile:d,getNotifications:u}=(0,s.P)(),{data:f,isLoading:_,isError:h,error:v}=(0,a.useQuery)({queryKey:n?N.lH.profileByPublicKey(i):N.lH.profileByUsername(c),queryFn:async()=>{var e;let o=n?await d({PublicKeyBase58Check:i}):await d({Username:c});if(!o.success||!(null===(e=o.data)||void 0===e?void 0:e.Profile))throw Error(o.error||"Failed to load profile");return o.data.Profile}}),{data:p,fetchNextPage:m,hasNextPage:x,isFetchingNextPage:j,isLoading:b,error:P}=(0,l.useInfiniteQuery)({queryKey:N.lH.notifications(n?c:null==f?void 0:f.PublicKeyBase58Check),queryFn:async e=>{let{pageParam:i=-1}=e,o=await u({FetchStartIndex:i,NumToFetch:50,PublicKeyBase58Check:n?c:null==f?void 0:f.PublicKeyBase58Check});if(!o.success)throw Error(o.error||"Failed to fetch notifications");return o.data},getNextPageParam:e=>{let i=(null==e?void 0:e.Notifications)||[];if(i.length<50)return;let n=i.at(-1);return(null==n?void 0:n.Index)?n.Index-1:void 0},enabled:!!(n?c:null==f?void 0:f.PublicKeyBase58Check),staleTime:15e3}),y=(0,r.useRef)(null);if((0,r.useEffect)(()=>{if(!x||j)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&m()},{rootMargin:"200px 0px",threshold:0}),i=y.current;return i&&e.observe(i),()=>{i&&e.unobserve(i)}},[x,j,m]),_)return(0,o.jsx)("p",{children:"Loading profile..."});if(h)return(0,o.jsx)("p",{style:{color:"red"},children:v.message});if(b)return(0,o.jsx)("p",{children:"Loading notifications..."});if(P)return(0,o.jsx)("p",{style:{color:"red"},children:P.message});let k=(null==p?void 0:p.pages.flatMap(e=>e.Notifications||[]))||[],g={},L={};return null==p||p.pages.forEach(e=>{e.PostsByHash&&Object.assign(g,e.PostsByHash),e.ProfilesByPublicKey&&Object.assign(L,e.ProfilesByPublicKey)}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I.M,{profile:f,rawParam:i}),0===k.length&&(0,o.jsx)("p",{children:"No notifications found."}),(0,o.jsx)("div",{className:w().notificationsContainer,children:k.map(e=>(0,o.jsx)("div",{children:(0,o.jsx)(C,{notification:e,postsByHash:g,profilesByPublicKey:L})},"".concat(e.Index)))}),(0,o.jsx)("div",{ref:y,style:{height:"1px"}}),j&&(0,o.jsx)("p",{children:"Loading more notifications..."})]})}},5981:e=>{e.exports={fabContainer:"UserQuickLinks_fabContainer__Q5xv3",fabButton:"UserQuickLinks_fabButton__1Oocl",fabIconClose:"UserQuickLinks_fabIconClose__vXLbD",fabIconMenu:"UserQuickLinks_fabIconMenu__9tMCF",menuWrapper:"UserQuickLinks_menuWrapper__ma7Bq",dropdown:"UserQuickLinks_dropdown__snFr7",linksSection:"UserQuickLinks_linksSection__c4A7M",menuOpen:"UserQuickLinks_menuOpen__hJ9GZ",menuClosed:"UserQuickLinks_menuClosed__XJmw7",avatarWrapper:"UserQuickLinks_avatarWrapper__wP_nJ",link:"UserQuickLinks_link__iEXZL",active:"UserQuickLinks_active__ZZ2TW"}},6189:e=>{e.exports={notification:"Notification_notification__CEEma",notificationWithThread:"Notification_notificationWithThread__rgSNm",parentPostContainer:"Notification_parentPostContainer__kAh3L",open:"Notification_open__87QLF",submittedPostContainer:"Notification_submittedPostContainer__bceuS",toggleButton:"Notification_toggleButton__Uu_qT",diamondsIcon:"Notification_diamondsIcon__QkBKA",followIcon:"Notification_followIcon__J_irG",reactionIcon:"Notification_reactionIcon__egDtg",transferIcon:"Notification_transferIcon__2DRAO",plusIcon:"Notification_plusIcon__A4eDm",reactionEmoji:"Notification_reactionEmoji__aTQ11",like:"Notification_like__MG_ju",bounce:"Notification_bounce__rKHVA",love:"Notification_love__z1ofF",pulse:"Notification_pulse__Ie0ge",laugh:"Notification_laugh__R9Yys",wiggle:"Notification_wiggle__AKCv0",astonished:"Notification_astonished___d1ZI",astonishedSoft:"Notification_astonishedSoft___pO4I",sad:"Notification_sad__2KKmO",sadNod:"Notification_sadNod___GQ8q",angry:"Notification_angry__Jtl4C",shake:"Notification_shake__bvN5i",dislike:"Notification_dislike___FKZq",bounceReverse:"Notification_bounceReverse__6oarx",notificationHeader:"Notification_notificationHeader__Yv0YN",notificationContent:"Notification_notificationContent__qKwIV",avatarMobile:"Notification_avatarMobile__VRN_4",notificationSummary:"Notification_notificationSummary__xy8b7",postLinkWrapper:"Notification_postLinkWrapper__YyeNZ",postLink:"Notification_postLink__6t0fp",postSnippet:"Notification_postSnippet__zi76h",avatar:"Notification_avatar__5Q3_J",pop:"Notification_pop__qFgl7",droop:"Notification_droop__pJwZJ"}},7390:(e,i,n)=>{Promise.resolve().then(n.bind(n,8902)),Promise.resolve().then(n.bind(n,7252)),Promise.resolve().then(n.bind(n,6715)),Promise.resolve().then(n.bind(n,382)),Promise.resolve().then(n.bind(n,8822)),Promise.resolve().then(n.bind(n,2490)),Promise.resolve().then(n.bind(n,5041)),Promise.resolve().then(n.bind(n,9138)),Promise.resolve().then(n.bind(n,1610)),Promise.resolve().then(n.bind(n,5838)),Promise.resolve().then(n.bind(n,5490)),Promise.resolve().then(n.bind(n,1142)),Promise.resolve().then(n.bind(n,3666)),Promise.resolve().then(n.bind(n,5663)),Promise.resolve().then(n.t.bind(n,7405,23))},7405:e=>{e.exports={page:"Page_page__6ZDsr",noPadding:"Page_noPadding__szQIs"}},8725:(e,i,n)=>{"use strict";n.d(i,{M:()=>v});var o=n(5155),s=n(2115),t=n(6874),a=n.n(t),l=n(5695),r=n(9300),c=n.n(r),d=n(9987),u=n(5146),f=n(5781),_=n(5981),h=n.n(_);let v=e=>{let{profile:i,rawParam:n}=e,t=(0,l.usePathname)(),[r,_]=(0,s.useState)(!1),v=encodeURIComponent(n),p=(0,s.useRef)(null),m=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=window.scrollY,i=0,n=()=>{let n=window.scrollY;i+=Math.abs(n-e),r&&i>30&&(_(!1),i=0),e=n};return r&&(i=0,e=window.scrollY),window.addEventListener("scroll",n,{passive:!0}),()=>window.removeEventListener("scroll",n)},[r]),(0,u.L)([p,m],()=>{r&&_(!1)}),(0,o.jsxs)("div",{className:h().fabContainer,children:[(0,o.jsxs)("button",{ref:m,onClick:()=>{_(e=>!e)},className:h().fabButton,children:[r?(0,o.jsx)("span",{className:h().fabIconClose,children:"\xd7"}):(0,o.jsx)("span",{className:h().fabIconMenu,children:"☰"})," "]}),(0,o.jsx)("div",{ref:p,className:c()(h().menuWrapper,{[h().menuOpen]:r,[h().menuClosed]:!r}),children:(0,o.jsxs)(f.m,{className:h().dropdown,children:[(0,o.jsx)(a(),{href:"/".concat(v),className:h().avatarWrapper,onClick:()=>_(!1),children:(0,o.jsx)(d.e,{profile:i,size:"medium"})}),(0,o.jsx)("div",{className:h().linksSection,children:[{label:"\uD83D\uDCDD User Posts",href:"/".concat(v,"/posts")},{label:"\uD83D\uDE42 Follow Feed",href:"/".concat(v,"/feed")},{label:"\uD83D\uDD14 Notifications",href:"/".concat(v,"/notifications")}].map(e=>{let{label:i,href:n}=e;return(0,o.jsx)(a(),{href:n,onClick:()=>_(!1),className:c()(h().link,{[h().active]:t===n}),children:i},i)})})]})})]})}}},e=>{var i=i=>e(e.s=i);e.O(0,[210,889,829,221,231,272,545,9,866,729,799,161,414,578,374,441,684,358],()=>i(7390)),_N_E=e.O()}]);